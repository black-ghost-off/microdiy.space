+++
title = 'Робимо з клона майже оригінал (stlinkv2)'
date = 2024-06-26T10:56:30+03:00
draft = false
summary = 'Гарний інструмент коштує **дорого**.'
cover = '/images/stlinkv2Clone1.jpg'

+++

> Гарний інструмент коштує **дорого**

# Хейт спіч (вступ)

В випадку з оригінальними девкітами, дебагерами, програматорами це інколи дуже гарні гроші, прям дуже
Тому в роки студентства я не міг собі дозволити оригінальний *St Link V2* і тому довгий час возився з свистками з не зрозумілими клонами *stm32f103***** в середині, що мені коштували не один нейрончик спалений в моїй голові.

Після десятка годин роботи з неякісними клонами я вирішив взяти себе в руки і купити оригінальний, красивий *StLink V2*
![alt](/images/stlinkv2Clone1.jpg)
![alt](/images/mb936_internal-front2.jpg)

І все було б добре, якби це був оригінал...
Проблема виникла в дуже не приємний момент. Коли мені скидають бінарнік для прошивки плати, я підключаюсь *STM32CubeProgrammer *і ніби все добре, а плата не підключається, заходжу в *STM32CubeIDE*, прошиваю звідти прошивкою - Все ок, починаю дебажити - Все ок... А програмер працювати не хоче(

Трохи почухав голову, згадав що міняв версію прошивки і після цьогоооо замість Serial Number, в мене буковка T появилась... А потім я ще перепрошивав з *ST-LinkV2* на *J-Link* (треба було для *NRF *терміново програматор, а нічого більше не було під рукою) і тоді нічого не працювало... І тут мене почали кусати думки що походу це не оригінал...

Відкривши кришку я побачив доволі знайомий з студентства **"geehy apm32f103cbt6"**. Це не поганий клон stm32, він працює в програматорах, але це клон, клони рідко коли бувають краще, або хоча б такі як оригінал... Тому я почав думати.

Мені треба "оригінальний" і робочий інструмент.

# Що треба робити?

Цей програматор працює з *STM32 Utility*(примітка, ті МК з якими я працюю не працюють ВЖЕ з цією апкою, вона актуальна під старі чіпи) тому зашити через неї в оригінальний *STM32F103C8T6 *якусь прошивку не складе великої проблеми.

Беремо *Bluepill*

![alt](/images/stm32bluepill.jpg)

І зашиваємо [***firmware***](https://github.com/open-plc-com/firmwares/blob/master/STM32F103C8T6/ST-Link/STLinkV2.J16.S4.bin)

Наступний етап най противніший, переставляємо замість *geehy* stm32f103c8t6, по розпіновці вони абсолютно pin to pin.

Після вдалої трансплантації в вас повністю робочий *StLink V2.*

![alt](/images/stm32_cube_programmer.png)

Після цих маніпуляцій можна провести firmware upgrade і користуватися як вам потрібно як звичайним STLINK програматором.

Розпіновка SWD зберігається. JTAG не користуюсь, за нього не ручаюсь.
![alt](/images/stlinkv2pinout.jpg)

В теорії китайські свистки з цим же камушком теж можна переробити під "оригінальний" програматор.

![alt](/images/stlinkv2Clone2.jpg)
